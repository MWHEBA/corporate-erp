{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load crispy_forms_tags %}
{% load custom_filters %}
{% load app_tags %}
{% load utils_extras %}

{% block title %}{{ page_title|default:"قائمة المخازن" }}{% endblock %}

{% block extra_css %}
<!-- جميع الستايلات موجودة في shared-components.css و components.css -->
<style>
  .warehouse-code {
    background: var(--gray-200);
    padding: 0.35rem 0.65rem;
    border-radius: 4px;
    font-size: 0.8rem;
    color: var(--text-primary);
    font-weight: 500;
    letter-spacing: 0.5px;
  }
  
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Page Header المركزي -->
    {% include "shared/page_header.html" %}


    <!-- جدول المخازن -->
    <div class="section-container">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="section-title mb-0"><i class="fas fa-list me-2"></i>قائمة المخازن</h5>
            <div class="actions-container">
                <span class="badge bg-primary me-2">{{ warehouses.count|smart_float }} مخزن</span>
            </div>
        </div>
        <div class="table-container">
            <!-- استخدام الجدول الموحد - المكون يتعامل مع الحالة الفارغة تلقائياً -->
            {% include "components/data_table.html" with table_id="warehouses-table" headers=warehouse_headers data=warehouses action_buttons=warehouse_actions empty_message="لا توجد مخازن متاحة" clickable_rows=True row_click_url="/products/warehouses/0/" show_export=True export_filename="warehouses" %}
        </div>
    </div>
</div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/global-table.js' %}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // التحقق من وجود الجدول قبل التهيئة
    const tableElement = document.getElementById('warehouses-table');
    if (tableElement && typeof initializeAllTables === 'function') {
        initializeAllTables();
    }
});
</script>
{% endblock %} 